For Pipeline Designers
**********************

The pipeline idea
=================

A **LOST-Pipeline** consists of different elements that will be
processed in a defined order by the *LOST-Engine* to transform data into 
knowledge.

A *LOST-Pipeline* is defined by a **PipelineTemplate** and modeled as directed graph.
A *Pipeline* is an istance of a *PipelineTemplate*.
A *PipelineTemplate* may define a graph that consits of the following
**PipelineElements**:

* **Script**: A user defined script that transforms input data to output data.
* **Datasource**: Input data for a annotation pipeline. In most cases this will be a folder with images.
* **AnnotationTask**: Some kind of an image annotation task performed by a
  human annotator.
* **Visualization**: Can display an image or html text in the web gui that was
  generated by a user defined script.
* **DataExport**: Provides a download link to a file that was generated by a
  script.
* **Loop**: A loop element points to another element in the *Pipeline* and creates
  a loop in the graph. A loop element implements a similar behaviour as a while
  loop in a programming language.

Designing a Pipeline
====================
In the following we will have a look at the **sia_all_tools** pipeline
which is part of the **sia** pipeline project example in LOST.
Based on this example we will discuss all the important steps when 
developing your own pipeline.

Pipeline Projects
-----------------
A **pipeline** is defined by a json file and is related to **Script** 
elements. 
A **Script** is essentialy a python file.
Multiple pipelines and scripts can be bundled as a **pipeline project**
and imported into lost.
A **pipeline project** is defined as a folder of **pipeline** and 
**script** files.
The listing below shows the file sturcture of the **sia pipeline project**.
In our example we will focus on the **sia_all_tools** pipeline and its 
related scripts (**export_csv**, **request_annos**),
which are highlighted in the listing.

.. literalinclude:: sia_pipe_project.txt
   :emphasize-lines: 2,3,6

Pipeline Definition Files?
--------------------------
Below you can see the first part of the **pipeline definition file**
of the **sia_all_tools** pipeline.
The pipeline is defined by a json object that has a *description*,
a *author*, 
a *pipe-schema-version* and a list of pipeline *elements*.
Each element is defined by a json object and has a *peN*
(*pipeline element number*) which is the identifier of the element
itself.
All elements need also a attribute that is called *peOut* and contains a 
list of elements where the current element is connected to.

The first pipeline element is a **Datasource** (lines 5 - 11)
of type **rawFile**.


.. literalinclude:: ../../../backend/lost/pyapi/examples/pipes/sia/sia_all_tools.json
    :language: json
    :linenos:

The first element in the pipeline is a 

How to write a script?
----------------------

.. literalinclude:: ../../../backend/lost/pyapi/examples/pipes/sia/request_annos.py
   :language: python
   :linenos:

.. literalinclude:: ../../../backend/lost/pyapi/examples/pipes/sia/export_csv.py
   :language: python
   :linenos: